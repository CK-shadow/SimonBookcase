---
title: 计算机组成原理-哈尔滨工业大学
date: 2020-09-15 23:44:50
tags: 计算机组成原理
categories: 计算机组成
top_img: https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/1240.jpg
cover: https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/1240.jpg
---

![1240](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/1240.jpg)

https://www.bilibili.com/video/BV1ix41137Eu?from=search&seid=17192528101127840792

# 计算机系统简介



### 计算机软硬件的概念



#### 计算机系统

![image-1613879482](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/1613879482.jpg)



------



#### 计算机系统的层次结构

![image-20200711201924842](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200711201924842.png)



第0级：硬联逻辑级，这是计算机的内核，由门、触发器等逻辑电路组成  
第1级：微程序级，这级的机器语言是微指令集，程序员用微指令编写的微程序，一般是直接由硬件执行的
第2级：传统机器级，这级的机器语言是该级的指令集，程序员用机器指令编写的程序可以由微程序进行解释
第3级：操作系统级，从操作系统的基本功能来看，一方面它要直接管理传统机器中的软硬件资源，另一方面它又是传统机器的延伸
第4级：汇编语言级，这级的机器语言是汇编语言，完成汇编语言翻译的程序叫做汇编程序
第5级：高级语言级，这级的机器语言就是各种高级语言，通常用编译程序来完成高级语言翻译的工作



| 分类         | 主要工作                                                                                     | 示例           |
| -------------- | ------------------------------------------------------------------------------------------------ | ---------------- |
| 计算机体系结构 | 程序员所见到的计算机系统的属性、概念性的结构与功能特性（指令系统、数据类型、寻址技术、IO机理等） | 有无乘法指令 |
| 计算机组成 | 实现计算机体系结构所体现的属性（具体指令的实现）                         | 如何实现乘法指令 |

------



### 计算机的基本组成

#### 冯·诺依曼计算机的特点



1. 计算机由五大部分组成（运算器、存储器、控制器、输入设备和输出设备）
2. 指令和数据以同等地位存于存储器，可按地址寻访
3. 指令和数据用二进制表示
4. 指令由操作码和地址码组成
5. 存储程序
6. 以运算器为中心

------



#### 冯·诺依曼计算机硬件框图
![](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/1613880559.jpg)



早期的冯·诺依曼计算机是以运算器为核心的



![image-20200711201945973](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200711201945973.png)

------



#### 现代计算机硬件框图

![](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/1613881297.jpg)



现代的计算机以存储器为核心，可将一些不常用的数据放于存储器而不是运算器中，减小CPU的负载



![image-20200711201959634](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200711201959634.png)

------



### 计算机的解题过程



#### 存储器的基本组成



![image-20200712123424898](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200712123424898.png)



存储体是由存储单元构成，而存储单元是由一个个的存储元件构成，存储元件中则保存着0或1的信息

存储单元：存放一串二进制代码

存储字：存储单元中二进制代码的组合

存储字长：存储单元中二进制代码的位数，每个存储单元赋予一个地址，存储单元是按地址寻访的

------



#### 运算器的基本组成

![image-20200712233611705](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200712233611705.png)



ALU：算术逻辑单元

ACC：累加器

MQ：乘商寄存器

X:累加寄存器

------



#### 计算机硬件的主要技术指标



1. 机器字长
CPU一次能处理数据的位数，与CPU中的寄存器位数有关

2. 运算速度

![](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/1613894103.jpg)

3. 存储容量

   存放二进制信息的位数，主存容量+辅存容量
   
   ------
   
   

# 计算机的发展与应用



### 计算机的发展史



#### 计算机的产生与发展



第一台计算机  1946年  ENIAC  采用十进制运算

------



#### 现代计算机产生的驱动力



* 需求、需求还是需求
* 技术发展
  * 电子技术发展
  * 计算机体系结构技术的发展

------



#### 硬件技术对计算机更新换代的影响

|  代  |    时间     |     硬件技术     | 速度（次/秒） |
| :--: | :---------: | :--------------: | :-----------: |
|  一  | 1946 - 1957 |      电子管      |    40 000     |
|  二  | 1958 - 1964 |      晶体管      |    200 000    |
|  三  | 1965 - 1971 | 中小规模集成电路 |   1 000 000   |
|  四  | 1972 - 1977 |  大规模集成电路  |  10 000 000   |
|  五  | 1978 - 现在 | 超大规模集成电路 |  100 000 000  |



### 微型计算机的出现和发展



微处理器芯片  1971年

存储器芯片  1970年

* 摩尔定律

当价格不变时，集成电路上可容纳的元器件的数目，约每隔18-24个月便会增加一倍，性能也将提升一倍。换言之，每一美元所能买到的电脑性能，将每隔18-24个月翻一倍以上。这一定律揭示了信息技术进步的速度 。尽管这种趋势已经持续了超过半个世纪，摩尔定律仍应该被认为是观测或推测，而不是一个物理或自然法

------



### 计算机技术的兴起与发展



#### 各种语言



机器语言  面向机器

汇编语言  面向机器

高级语言  面向问题

------

​	

#### 系统语言



语言处理程序 ： 汇编语言、编译语言、解释程序

操作系统：  DOS、WINDOWS、UNIX、LINUX

服务性程序： 装配、调试、诊断、排错

数据库管理系统： 数据库与数据库管理软件

网络软件

------



#### 软件发展的特点



开发周期长

制作成本昂贵

检测软件产品质量的特殊性

------

# 系统总线

### 总线的基本概念

------



####  什么是总线



总线是连接各个部件的信息传输线，是各个部件共享的传输介质



------

### 总线的分类



* 片内总线  芯片内部的总线
* 系统总线  计算机各部件之间的信息传输线
  * 数据总线  双向，与机器字长、存储字长有关
  * 地址总线  与存储地址、I/O地址有关
  * 控制总线  有出、有入
* 通信总线  用于计算机系统之间或计算机系统与其它系统之间的通信



------

### 总线的特性及性能指标

#### 总线的特性



* 机械特性：尺寸、形状、管脚数及排列顺序
* 电气特性：传输方向和有效的电平范围
* 功能特性：每根传输线的功能
* 时间特性：信号的时序关系



------

#### 总线的性能指标



* 总线宽度：数据线的根数
* 标准传输率：每秒传输的最大字节数（MBps）
* 时针同步/异步：同步、不同步
* 总线复用：地址线与数据线复用
* 信号线数：地址线、数据线和控制线的总和
* 总线控制方式：突发、自动、仲裁、逻辑、计数
* 其它指标：负载能力



------

### 总线的结构

#### 单总线结构



![image-20200718194446574](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200718194446574.png)

计算机的各个部件均由系统总线相连，在单总线结构中，CPU与主存之间、CPU与I/O设备之间、I/O设备与主存之间、各种设备之间都通过系统总线交换信息。单总线结构的优点是控制简单方便，扩充方便。但由于所有设备部件均挂在单一总线上，使这种结构只能分时工作，即同一时刻只能在两个设备之间传送数据，这就使系统总体数据传输的效率和速度受到限制，这是单总线结构的主要缺点



------

#### 面向CPU的双总线结构



![image-20200718194633736](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200718194633736.png)

其中一组总线是CPU与主存储器之间进行信息交换的公共通路，称为存储总线。另一组是CPU与I/O设备之间进行信息交换的公共通路，称为输入/输出总线（I/O总线）。外部设备通过连接在I/O总线上的接口电路与CPU交换信息



------

#### 面向存储器的双总线结构



![image-20200718194748169](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200718194748169.png)

面向存储器的双总线结构保留了单总线结构的优点，即所有设备和部件均可通过总线交换信息。与单总线结构不同的是在CPU与存储器之间，又专门设置了一条高速存储总线，使CPU可以通过它直接与存储器交换信息。面向存储器的双总线结构信息传送效率较高，这是它的主要优点。但CPU与I/O接口都要访问存储器时，仍会产生冲突



------

### 总线控制

#### 总线判优控制



* 主设备：对总线有控制权
* 从设备：响应从主设备发来的响应命令



![](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20210221122924541.png)





------

### 总线通信控制

* 目的：解决通信双方协调配合问题
* 总线传输周期

![](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/1613895647.jpg)



------

#### 总线通信的四种方式



* 同步通信：由统一时标控制数据传送
* 异步通信：采用应答方式，没有公共时钟标准
* 半同步通信：同步、异步结合
* 分离式通信：充分挖掘系统总线每个瞬间的潜力



# 存储器

### 概述

#### 存储器分类



* 按存储介质分类：半导体存储器、磁表面存储器、磁芯存储器、光盘存储器
* 按存取方式分类：存取时间与物理地址无关（随机访问）、存取时间与物理地址有关（串行访问）
* 按在计算机中的作用分类：主存储器、辅助存储器



------

#### 存储器的层次结构



![image-20200723230112902](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200723230112902.png)





### 半导体存储芯片简介

#### 半导体存储芯片的基本结构



![image-20200726234653540](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200726234653540.png)

![image-20200726234709386](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200726234709386.png)



------

#### 半导体存储芯片的译码驱动方式



* 线选法

  所谓线选法, 就是直接以系统的地址线作为存储器芯片的片选信号, 为此只需把用到的地址线与存储器芯片的片选端直接相连即可

* 重合法（也叫译码法）

  全译码法将除片内寻址外的全部高位地址线都作为地址译码器的输入，译码器的输出作为各芯片的片选信号，将它们分别接到存储芯片的片选端，以实现对存储芯片的选择



------

### 主存储器 -- 随机存取存储器

#### 静态RAM(SRAM)

所谓的“静态”，是指这种存储器只要保持通电，里面储存的数据就可以恒常保持



![image-20200727225237505](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200727225237505.png)



假设准备往6T存储单元写入“1”，先将某一组地址值输入到行、列译码器中，选中特定的单元，然后使写使能信号WE有效，将要写入的数据“1”通过写入电路变成“1”和“0”后分别加到选中单元的两条位线BL,BLB上，此时选中单元的WL=1，晶体管N0,N5打开，把BL,BLB上的信号分别送到Q,QB点，从而使Q=1，QB=0，这样数据“1”就被锁存在晶体管P2,P3,N3,N4构成的锁存器中。写入数据“0”的过程类似



SRAM的读过程以读“1”为例，通过译码器选中某列位线对BL,BLB进行预充电到电源电压VDD，预充电结束后，再通过行译码器选中某行，则某一存储单元被选中，由于其中存放的是“1”，则WL=1、Q=1、QB=0。晶体管N4、N5导通，有电流经N4、N5到地，从而使BLB电位下降，BL、BLB间电位产生电压差，当电压差达到一定值后打开灵敏度放大器，对电压进行放大，再送到输出电路，读出数据



------

### 主存储器 -- 只读存储器（ROM）



只读存储器（Read-Only  Memory，ROM）以非破坏性读出方式工作，只能读出无法写入信息。信息一旦写入后就固定下来，即使切断电源，信息也不会丢失，所以又称为固定存储器。ROM所存数据通常是装入整机前写入的，整机工作过程中只能读出，不像随机存储器能快速方便地改写存储内容。ROM所存数据稳定 ，断电后所存数据也不会改变，并且结构较简单，使用方便，因而常用于存储各种固定程序和数据



#### 只读存储器的分类



* 掩膜编程的只读存储器MROM

  只可在生产过程中写入一次，可靠性高，写入后便不能更改，因此灵活性差

* 可编程的只读存储器PROM

  可编程一次，且需要专用设备写入

* 可擦除可编程的只读存储器EPROM

  用户可通过电或光照的方式清空数据，重复写入

* 可电擦除可编程的只读存储器 EEPROM

  随时可写入且无需擦除原先内容，可在线修改，因此可靠性较低

* 快擦除读写存储器

  具备EEPROM和RAM的特点，先已广泛应用于各种移动存储器，如U盘和存储卡



------

### 主存储器与CPU的连接

#### 存储容量的扩展



位扩展，位扩展法指的是用若干片位数较少的存储芯片构成具有给定字长的存储器，即增加数据线

字扩展，字扩展法指的是增加存储器中字的数量，即增加地址线

字位扩展，字位扩展是指即增加存储字的数量，又增加存储字长



------

#### **存储器与CPU连接**



1. 地址线连接：通常将CPU地址线的低位与存储芯片的地址线相连（CPU地址线多于存储芯片地址线）
2. 数据线连接 : 若存储芯片与CPU的数据线不相等，就对存储芯片进行扩位（使他们数据位数相等）
3. 读 / 写命令线连接 ：高电平为读，低电平为写
4. 片选线连接 ：是CPU与存储芯片正确工作的关键。片选有效信号与CPU的访存信号MREQ（低电平有效，有效时，这次访问的地址才在存储器当中）有关
5. 合理选择存储芯片 ：ROM存放系统程序，RAM为用户编程设计。



------

### 高速缓冲存储器

#### 简介



高速缓冲存储器（Cache）其原始意义是指存取速度比一般随机存取记忆体（RAM）来得快的一种RAM，一般而言它不像系统主记忆体那样使用DRAM技术，而使用昂贵但较快速的SRAM技术，也有快取记忆体的名称



高速缓冲存储器是存在于主存与CPU之间的一级存储器， 由静态存储芯片(SRAM)组成，容量比较小但速度比主存高得多，  接近于CPU的速度。在计算机存储系统的层次结构中，是介于中央处理器和主存储器之间的高速小容量存储器。它和主存储器一起构成一级的存储器。高速缓冲存储器和主存储器之间信息的调度和传送是由硬件自动进行的。高速缓冲存储器最重要的技术指标是它的命中率

------



#### 组成结构



* Cache存储体：存放由主存调入的指令与数据块
* 地址转换部件：建立目录表以实现主存地址到缓存地址的转换
* 替换部件：在缓存已满时按一定策略进行数据块替换，并修改地址转换部件



------



#### 替换策略



* 随机法（RAND法）
* 先进先出法（FIFO法）
* 最近最少使用法（LRU法）



------

### 辅助存储器

#### 概述



主存的后备和扩充，也称外存。
特点:容量大,可靠性高,单位存储容量价格低,在掉电情况下能长期保存信息



![image-20200801130932937](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200801130932937.png)

------



#### 技术指标



1. 存储密度
2. 存储容量，有格式化容量和非格式化容量两个指标
3. 寻址时间
4. 数据传输率
5. 误码率
6. 价格



------



# 输入输出系统



### 概述

#### 输入输出系统的发展概况



1. 早期

   分散连接，CPU 和 I/O 设备串行工作

2. 接口模式和 DMA 阶段

   总线连接，CPU 和 I/O 设备并行工作

3. 具有通道结构的阶段

4. 具有 I/O 处理机的阶段



#### I/O设备与主机的联络方式



1. I/O 设备编址方式

   * 统一编址，将 I/O 设备看作存储器的一部分，通过存数、取数指令操作
   * 不统一编址，有专门的 I/O 指令

2. 设备选址

   用设备选择电路识别是否被选中

3. 传送方式

   * 串行
   * 并行

4. 联络方式

   * 立即响应
   * 异步工作采用应答信号
   * 同步工作采用同步时标

5. I/O 设备与主机的连接方式

   * 辐射式连接
   * 总线连接



------

#### I/O设备与主机信息传送的控制方式



1. 程序查询方式

   通过轮询的方式在I/O设备准备完成后CPU再进行操作，属于串行方式

   ![image-20200803004123000](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200803004123000.png)


2. 程序中断方式

   I/O设备在准备完成后会向CPU发出请求中断程序指令，属于部分并行方式
   
   ![](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/1613895766.jpg)
   
3. DMA方式

   主存与 I/O 之间有一条直接数据通道，不中断现行程序



------

### I/O设备

#### 概述



外部设备大致分为三类

* 人机交互设备，例如键盘、鼠标、显示器等等
* 计算机信息存储设备，例如磁盘、光盘等
* 机-机通信设备，例如调制解调器等



------

### 程序查询方式

#### 程序查询方式

* 单个设备

  ![image-20200808204537211](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200808204537211.png)

* 多个设备

  ![image-20200808204604967](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200808204604967.png)



#### 程序查询方式接口电路

![image-20200808204718186](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200808204718186.png)





------

### 程序中断方式

#### 中断的概念



中断是指计算机运行过程中，出现某些意外情况需主机干预时，机器能自动停止正在运行的程序并转入处理新情况的程序，处理完毕后又返回原被暂停的程序继续运行



------

#### 程序中断方式的接口电路



1. 配置中断请求触发器 INTR 和中断屏蔽触发器 MASK（避免优先级较高的请求被打断）
2. 排队器（将中断请求按优先级顺序进行排队）

3. 中断向量地址形成部件（寻找中断服务程序的入口地址）



------

### I/O中断处理过程

#### CPU响应中断的条件与时间



条件：允许中断触发器 EINT=1，可通过关指令或硬件复位将 EINT 置为 0

时间：在每条指令执行阶段的结束前，CPU 发出中断查询信号



------

#### 中断服务程序流程



1. 保护现场，包括程序断点的保护和寄存器内容的保护
2. 中断服务，不同的 I/O 设备具有不同内容的设备服务
3. 恢复现场
4. 中断返回



------

#### 单重中断和多重中断



单重中断：不允许中断现行的中断服务程序

多重中断：允许级别更高的中断源中断现行的中断服务程序



------

### DMA方式（直接存储器访问）

#### 概念



DMA(Direct Memory Access，直接存储器访问) 是所有现代电脑的重要特色，它允许不同速度的硬件装置来沟通，而不需要依赖于 CPU 的大量中断负载。否则，CPU 需要从来源把每一片段的资料复制到暂存器，然后把它们再次写回到新的地方。在这个时间中，CPU 对于其他的工作来说就无法使用



------

#### 原理



DMA 传输将数据从一个地址空间复制到另外一个地址空间。当CPU 初始化这个传输动作，传输动作本身是由 DMA 控制器来实行和完成。典型的例子就是移动一个外部内存的区块到芯片内部更快的内存区。像是这样的操作并没有让处理器工作拖延，反而可以被重新排程去处理其他的工作。DMA 传输对于高效能嵌入式系统算法和网络是很重要的



在实现DMA传输时，是由DMA控制器直接掌管总线，因此，存在着一个总线控制权转移问题。即DMA传输前，CPU要把总线控制权交给DMA控制器，而在结束DMA传输后，DMA控制器应立即把总线控制权再交回给CPU。一个完整的DMA传输过程必须经过DMA请求、DMA响应、DMA传输、DMA结束4个步骤



------

#### 传送方式

1. 停止 CPU 访问内存

   当外围设备要求传送一批数据时，由DMA控制器发一个停止信号给CPU，要求CPU放弃对地址总线、数据总线和有关控制总线的使用权。DMA控制器获得总线控制权以后，开始进行数据传送。在一批数据传送完毕后，DMA控制器通知CPU可以使用内存，并把总线控制权交还给CPU

2. 周期挪用

   当I/O设备没有DMA请求时，CPU按程序要求访问内存；一旦I/O设备有DMA请求，则由I/O设备挪用一个或几个内存周期

3. DMA 与 CPU 交替访问内存

   假设CPU工作周期为1.2us，内存存取周期小于0.6us，那么一个CPU周期可分为C1和C2两个分周期，其中C1专供DMA控制器访内，C2专供CPU访内



# 计算机中的数字

### 无符号数和有符号数

#### 简介



 无符号数：即没有正负号的数字，寄存器的位数就反映了无符号数的表示范围（0 ~ 2^位数）

有符号数：即有正负号的数字，在寄存器中通过首位的 0 或 1 表示这是个正数还是负数，而小数点的位置则以约定的方式给出



------



#### 原码表示法



原码(true form)是一种计算机中对数字的二进制定点表示方法。原码表示法在数值前面增加了一位符号位（即最高位为符号位）：正数该位为0，负数该位为1（0有两种表示：+0和-0），其余位表示数值的大小

优点：简单直观

缺点：原码不能直接参加运算，可能会出错



原码表示法表示正数：

![](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/1613895837.jpg)

原码表示法表示小数：



![](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/1613895883.png)



------

#### 补码表示法



模：指一个计量系统的计数范围

模实质上是计量器产生“溢出”的量，它的值在计量器上表示不出来，计量器上只能表示出模的余数。任何有模的计量器，均可化减法为加法运算



* 一个负数加上模即得到该负数的补数
* 一个正数和一个负数互为补数时，他们的绝对值之和即为模数
* 正数的补数即为其本身



------

#### 反码表示法



反码通常是用来由原码求补码或者由补码求原码的过渡码。原码最大的问题就在于一个数加上他的相反数不等于零，于是反码的设计思想就是冲着解决这一点，既然一个负数是一个正数的相反数，那我们干脆用一个正数按位取反来表示负数



* 正数的反码还是等于原码
* 负数的反码就是他的原码除符号位外，按位取反



反码表示法可以解决正数和正数、正数和负数的加法问题，但是无法解决负数和负数的加法问题，不过可以将负数与负数的加法换算为正数与负数的加法来解决这一问题



------

#### 移码表示法



补码在计算机运算里面运用到非常广泛， 因为它能将减法转换成加法， 由此可以简化运算。但是补码很难直接判断大小，补码形式的负数是要大于正数的



移码的表示方法

![](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/1613895942.jpg)

移码与补码就只有符号位相反，用移码表示阶码时能方便的判断大小



------

### 数的定点表示和浮点表示

#### 定点表示



定点表示指小数点按约定的方式标出，根据小数点位置的不同，主要分为两类：

* 小数点的位置在数符之后、数值之前，表示的全是小数
* 小数点的位置在数值之后，表示的全是整数



------

#### 浮点表示



把一个数的有效数字和数的范围在计算机的一个存储单元中分别予以表示。这种把数的范围和精度分别表示的方法，相当于数的小数点位置随比例因子的不同而在一定范围内可以自由浮动，所以称为浮点表示法



在计算机中一个任意二进制数N可以写成：   N=2^e * M
其中M称为浮点数的尾数，是一个纯小数。e是比例因子的指数，称为浮点数的指数，是一个整数。比例因子的基数2对二进记数制的机器是一个常数



按IEEE754标准，32位浮点数和64位浮点数的标准格式为

![image-20200824231131932](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200824231131932.png)



### 定点运算

#### 移位运算



移位运算符就是在二进制的基础上对数字进行平移。按照平移的方向和填充数字的规则分为三种：<<（左移）、>>（带符号右移）和>>>（无符号右移）



* <<（左移）：按二进制形式把所有的数字向左移动对应的位数，高位移出（舍弃），低位的空位补零

* \>>（带符号右移）：按二进制形式把所有的数字向右移动对应位数，低位移出（舍弃），高位的空位补符号位，即正数补零，负数补1

* \>>>（无符号右移）：按二进制形式把所有的数字向右移动对应巍峨位数，低位移出（舍弃），高位的空位补零。对于正数来说和带符号右移相同，对于负数来说不同



总结：正数的原码、反码、补码都是添补0；负数的原码添补0，反码添补1，补码左移添0，右移添1

------



#### 加减法运算



加法：二进制的加法就是位数对应，依次相加，两个1相加则进位

减法：计算机中没有专门的减法运算，减法运算也可以通过加法来实现，比如 a - b 可以看成 a + （-b）



介绍计算机中的数字表示法的时候有说到，原码、反码在进行减法运算的时候都有自己的局限性，因此计算机中一般采用的都是补码表示法



通过反码的方式来将减法转换成加法运算，通过补码的方式消除了+0和-0的歧义。而在减法的运算结果中，还需要对结果进行补码

------



#### 乘法运算



计算机中的乘法运算是通过加法预算和移位运算来实现的



比如 7 X 5，写成二进制的方式就是 0111 X 0101

![image-20200826205952476](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200826205952476.png)



规则就是，按照被乘数的低位到高位依次计算，如果第n位不为0，那么乘数就左移n位，如果第n为为0 ，那么这步运算结果记为0，最后将每一步的结果相加就是最终的计算结果

------



#### 除法运算



同乘法运算类似，计算机的除法运算也是通过加法运算和移位运算实现的



比如 123 / 4，写成二进制的方式就是 1111011 / 0100

![image-20200826221141398](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200826221141398.png)



规则就是按照除数的高位到低位的数字依次和被除数进行比对，如果大于等于被除数，则此步结果记为1，并求得余数，如果小于被除数则将上一步的余数左移一步加上一位的数字再次比较，以此类推，最终将依次计算的结果相连组成二进制就是商，最后一次的余数就是求余的结果

------



### 浮点运算

#### 加减法运算



浮点数的加减法运算主要分为以下5个步骤：

1. 对阶

   求阶差，右移阶码小的浮点数的尾数并同步增加其阶码，直至两数阶码相等

2. 尾数加/减

   尾数加/减运算（用对阶后的尾数）

3. 结果规格化

4. 舍入

   右移规格化时可能丢失一些低位的数值，为提高精度，可采取舍入的方法

   * 0舍1入：若右移出的是1则在最低位加1
   * 恒置1：只要数字位1被移掉，就将最后一位恒置成1

5. 溢出处理

   浮点数的溢出标志：阶码溢出

   * 阶码上溢：阶码的符号位为01
   * 阶码下溢：阶码的符号位为10



------

### 算术逻辑单元

#### ALU



算术逻辑单元是能实现多组算术运算和逻辑运算的组合逻辑电路，简称ALU。算术逻辑单元是中央处理器(CPU)的执行单元，是所有中央处理器的核心组成部分，由"And Gate"（与门） 和"Or Gate"（或门)）构成的算术逻辑单元，主要功能是进行二位元的算术运算，如加减乘(不包括整数除法)。基本上，在所有现代CPU体系结构中，二进制都以补码的形式来表示

![image-20200827213843667](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200827213843667.png)



------



# CPU

### 机器指令

#### 简介



机器指令是计算机CPU执行某种操作的命令编码。指令系统是指某一类型CPU中所有机器指令的集合。8086/8088CPU的指令系统共包含92种基本指令，按照功能可将它们分为6大类：数据传送指令、算术运算指令、逻辑运算和移位指令、串操作指令、控制转移指令、处理器控制指令



机器指令是由1，0组成的特定的二进制数序列。机器指令格式为：操作码字段 地址码字段。其中，操作码字段表示执行操作类型，地址码字段表示操作数的地址或操作数本身。一般的操作数有被操作数，操作数及操作结果三种类型



![image-20200829123256186](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200829123256186.png)



由于机器指令与CPU紧密相关，所以，不同种类的CPU所对应的机器指令也就不同，而且它们的指令系统往往相差很大。但对同一系列的CPU来说，为了满足各型号之间具有良好的兼容性，要做到：新一代CPU的指令系统必须包括先前同系列CPU的指令系统。只有这样，先前开发出来的各类程序在新一代CPU上才能正常运行



------

### 操作数类型和操作种类

#### 操作数类型



* 地址        无符号整数
* 数字        定点数、浮点数、十进制数
* 字符        ASCII
* 逻辑数    逻辑运算



------

#### 数据在存储器中的存放方式



1. 从任意位置开始存储
   * 优点：不浪费内存资源
   * 缺点：除了访问一个字节之外，其余的都可能花费两个存储周期的时间
2. 从一个存储字的起始位置开始存储
   * 优点：无论何种类型的数据，都可在一个存储周期内完成读写
   * 浪费资源
3. 边界对准方式，从地址的正数倍位置开始访问（上面两种方式的折中办法）



------

#### 操作类型



1. 数据传送
2. 算术逻辑操作
3. 移位操作
4. 转移
   1. 无条件转移
   2. 条件转移
   3. 调用和返回
   4. 陷阱与陷阱指令
5. 输入输出



------

### 寻址方式

#### 简介



寻址方式就是处理器根据指令中给出的地址信息来寻找有效地址的方式，是确定本条指令的数据地址以及下一条要执行的指令地址的方法



在存储器中，操作数或指令字写入或读出的方式，有地址指定方式、相联存储方式和堆栈存取方式。几乎所有的计算机，在内存中都采用地址指定方式。当采用地址指定方式时，形成操作数或指令地址的方式称为寻址方式。寻址方式分为两类，即指令寻址方式和数据寻址方式，前者比较简单，后者比较复杂。值得注意的是，在传统方式设计的计算机中，内存中指令的寻址与数据的寻址是交替进行的



------

#### 指令寻址



1. 顺序寻址方式

   由于指令地址在内存中按顺序安排，当执行一段程序时，通常是一条指令接一条指令地顺序进行。也就是说，从存储器取出第1条指令，然后执行这条指令；接着从存储器取出第2条指令，再执行第二条指令；接着再取出第3条指令。这种程序顺序执行的过程，称为指令的顺序寻址方式。为此，必须使用程序计数器PC来计数指令的顺序号，该顺序号就是指令在内存中的地址

2. 跳跃寻址方式

   当程序转移执行的顺序时，指令的寻址就采取跳跃寻址方式。所谓跳跃，是指下条指令的地址码不是由程序计数器给出，而是由本条指令给出。采用指令跳跃寻址方式，可以实现程序转移或构成循环程序，从而能缩短程序长度，或将某些程序作为公共程序引用



------

#### 操作数寻址



1. 隐含寻址

   这种类型的指令，不是明显地给出操作数的地址，而是在指令中隐含着操作数的地址

2. 立即寻址

   指令的地址字段指出的不是操作数的地址，而是操作数本身，这种寻址方式称为立即寻址

3. 直接寻址

   直接寻址是一种基本的寻址方法，其特点是：在指令格式的地址的字段中直接指出操作数在内存的地址

4. 间接寻址

   间接寻址是相对直接寻址而言的，在间接寻址的情况下，指令地址字段中的形式地址不是操作数的真正地址，而是操作数地址的指示器，或者说此形式地址单元的内容才是操作数的有效地址

5. 寄存器寻址方式和寄存器简介寻址方式

   当操作数不放在内存中，而是放在CPU的通用寄存器中时，可采用寄存器寻址方式。寄存器间接寻址方式与寄存器寻址方式的区别在于：指令格式中的寄存器内容不是操作数，而是操作数的地址，该地址指明的操作数在内存中

6. 相对寻址方式

   相对寻址是把程序计数器PC的内容加上指令格式中的形式地址D而形成操作数的有效地址

7. 基址寻址方式

   在基址寻址方式中将CPU中的基址寄存器的内容，加上变址寄存器的内容而形成操作数的有效地址

8. 变址寻址方式

   变址寻址方式与基址寻址方式计算有效地址的方法很相似，它把CPU中某个变址寄存器的内容与偏移量D相加来形成操作数有效地址。使用变址寻址方式的目的不在于扩大寻址空间，而在于实现程序块的规律变化

9. 块寻址方式

   块寻址方式经常用在输入输出指令中，以实现外存储器或外围设备同内存之间的数据块传送。块寻址方式在内存中还可用于数据块移动



# 机器

### CPU的结构与功能

#### 概念



![image-20200830212905336](https://simon-bookcase.oss-cn-beijing.aliyuncs.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86-%E5%93%88%E5%B0%94%E6%BB%A8%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6/image-20200830212905336.png)

处理器一般指中央处理器，中央处理器（CPU）是一块超大规模的集成电路，是一台计算机的运算核心（Core）和控制核心（ Control Unit）。它的功能主要是解释计算机指令以及处理计算机软件中的数据



要实现一个数字系统需要三个主要的组成部分：

1. 计算对位进行操作的函数的组合逻辑（ALU）
2. 存储位的存储器元素（寄存器）
3. 控制存储器元素更新的时钟信号



------

#### CPU的功能



1. 控制器的功能
   * 取指令
   * 分析指令
   * 执行指令，发出各种操作命令
   * 控制程序输入以及结果的输出
   * 总线管理
   * 处理异常情况和特殊请求
2. 运算器的功能
   * 实现算术运算和逻辑运算



------

### 指令周期

#### 概念



指令周期是取出一条指令并执行这条指令的时间。一般由若干个机器周期组成，是从取指令、分析指令到执行完所需的全部时间。指令周期类型有非访内指令的指令周期、取数指令的指令周期、存数指令的指令周期、空操作指令和转移指令的指令周期



------

#### 类别

* 非访内指令
  1. 区指令阶段
  2. 执行指令阶段
* 取数指令
  1. 送操作数地址
  2. 两操作数相加
* 存数指令
  1. 送操作数地址
  2. 存储和数
* 空操作指令
  1. 取指令阶段
  2. 执行指令阶段

------

### 指令流水

#### 原理



为提高处理器执行指令的效率，把一条指令的操作分成多个细小的步骤，每个步骤由专门的电路完成



例如一条指令要执行要经过3个阶段：取指令、译码、执行；每个阶段都要花费一个时钟周期，如果没有采用流水线技术，那么这条指令执行需要3个时钟周期；如果采用了指令流水线技术，那么当这条指令完成“取指”后进入“译码”的同时，下一条指令就可以进行“取指”了，这样就提高的指令的执行效率



------

#### 影响因素



* 资源相关

  资源相关是指当指令在重叠执行过程中，不同指令争用同一功能部件产生资源冲突时产生的。解决访存冲突的一个办法停顿，另一种是设置两个独立的存储器分别存放操作数和指令，以免取指令和取操作数冲突

* 数据相关

  数据相关是指令在流水线中重叠执行时，当后继指令需要用到前面的指令产生的结果时发生的

* 控制相关

  控制相关是当流水线遇到转移指令引起的。统计表明，转移指令约占总指令的四分之一左右，比起数据相关，它会使流水线丧失更多的功能



------

### 中断系统

#### 简介



中断装置和中断处理程序统称为中断系统

中断系统是计算机的重要组成部分。实时控制、故障自动处理、计算机与外围设备间的数据传送往往采用中断系统。中断系统的应用大大提高了计算机效率



不同的计算机其硬件结构和软件指令是不完全相同的，因此，中断系统也是不相同的。计算机的中断系统能够加强CPU对多任务事件的处理能力。中断机制是现代计算机系统中的基础设施之一，它在系统中起着通信网络作用，以协调系统对各种外部事件的响应和处理。中断是实现多道程序设计的必要条件。 中断是CPU对系统发生的某个事件作出的一种反应。 引起中断的事件称为中断源。中断源向CPU提出处理的请求称为中断请求。发生中断时被打断程序的暂停点成为断点。CPU暂停现行程序而转为响应中断请求的过程称为中断响应。处理中断源的程序称为中断处理程序。CPU执行有关的中断处理程序称为中断处理。而返回断点的过程称为中断返回。中断的实现实行软件和硬件综合完成，硬件部分叫做硬件装置，软件部分称为软件处理程序



------

#### 分类



中断源是指能够引起中断的原因。一台处理机可能有很多中断源,但按其性质和处理方法,大致可分为如下五类

1. 机器故障中断
2. 程序性中断
3. 输入－输出设备中断
4. 外中断
5. 调用管理程序



------

### 控制单元

#### 功能



它根据用户预先编好的程序，依次从存储器中取出各条指令，放在指令寄存器IR中，通过指令译码(分析)确定应该进行什么操作，然后通过操作控制器OC，按确定的时序，向相应的部件发出微操作控制信号。操作控制器OC中主要包括节拍脉冲发生器、控制矩阵、时钟脉冲发生器、复位电路和启停电路等控制逻辑